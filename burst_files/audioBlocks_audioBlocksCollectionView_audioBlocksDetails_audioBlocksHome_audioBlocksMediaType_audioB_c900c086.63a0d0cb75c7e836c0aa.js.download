(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{157:function(e,t,s){"use strict";s.d(t,"a",(function(){return h}));var o,i,a,r=s(291),n=s.n(r),l=s(1),c=s.n(l),d=s(0),p=s.n(d);class h extends d.Component{render(){return p.a.createElement("time",{className:"duration",dateTime:h.formatDurationForMachines(this.props.seconds)},h.formatDurationForHumans(this.props.seconds))}static formatDurationForMachines(e){return n()({seconds:e})}static formatDurationForHumans(e){const t=Math.floor(e/60),s=e-60*t;return`${t>9?""+t:"0"+t}:${s>9?""+s:"0"+s}`}}o=h,i="propTypes",a={seconds:c.a.number.isRequired},i in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a},293:function(e,t,s){"use strict";var o=s(6),i=s.n(o),a=s(1),r=s.n(a),n=s(0),l=s.n(n),c=s(150),d=s.n(c),p=s(2),h=s(10),m=s(9),u=s(59),g=s(389),w=s(319),k=s(25),v=s(56),b=s(390),f=s(141),S=s(7),I=s(210),C=s(320),y=s(51),T=s(5),F=s(8),E=s(139),N=s(525),P=s(526),D=s(99);function U(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class L extends n.Component{constructor(e){super(e),U(this,"handleIsHovering",()=>{this.props.formatSelectorVisible||(this.setState({isHovering:!0,hoverStartTime:Date.now()}),this.props.page&&this.props.dispatch(Object(F.s)(this.props.page,this.props.stockItem.id)))}),U(this,"handleIsNotHovering",e=>{var t,s,o;null!=e&&null!==(t=e.target)&&void 0!==t&&null!==(s=t.className)&&void 0!==s&&null!==(o=s.includes)&&void 0!==o&&o.call(s,"action-icon")||this.setState({isHovering:!1,playStartTime:null})}),U(this,"handleClickAction",e=>{Object(T.r)((null==e?void 0:e.nativeEvent)||e,this.containerRef.current)||this.handleIsNotHovering()}),U(this,"onSelectCheckboxClick",()=>{this.props.dispatch(Object(F.p)(this.props))}),U(this,"handleSelectedFormatChanged",(e,t)=>{this.props.dispatch(Object(F.l)({id:this.props.stockItem.id,selectedFormatName:e,selectedFormatResolution:t}))}),U(this,"handleOnTouchEnd",()=>{const{isDragging:e}=this.state;if(!e){const e=this.props.stockItem.detailsUrl;window.location.href=e}}),U(this,"setImgOrientationIfNecessary",()=>{if(this.stockItemHasAspectRatio())return;const e=this.refs.previewImage;if(e&&e.complete&&e.clientHeight&&e.clientWidth){const t=e.clientWidth/e.clientHeight;this.setState({imgOrientationCSSClass:t<=1?"portrait":"landscape"})}}),U(this,"getSimilarContentAction",()=>{if(this.props.drawerIsOpen&&this.props.drawerSelectedItemId===this.props.stockItem.id)this.props.dispatch(Object(F.d)());else{const{collapsedSetId:e,id:t}=this.props.stockItem,s={collapsedSetId:e,id:t,excludeStockItemIds:this.props.stockItem.id,page:1},o=this.props.selectedSearchFilterOptions.update(s);this.props.dispatch(Object(F.f)(o)),this.props.dispatch(Object(F.e)(t))}}),this.state={isDragging:!1,isHovering:!1,imgOrientationCSSClass:"hidden-no-aspect-ratio",showDownloadTooltip:!1,showFavoriteTooltip:!1,showMoreLikeThisTooltip:!1},this.containerRef=l.a.createRef()}componentDidMount(){this.containerRef.current.addEventListener("touchmove",()=>{this.state.isDragging||self.setState({isDragging:!0})}),this.containerRef.current.addEventListener("touchstart",()=>{this.state.isDragging&&self.setState({isDragging:!1})}),window.addEventListener("addToBin",this.addToBinHandler.bind(this)),Object(b.a)(this.containerRef.current,()=>{const e=this.props.stockItemCardContext||{};e.position&&g.a.push(w.a.displayedStockItem(this.props.stockItem,e.position))}),this.setImgOrientationIfNecessary(),this.shouldShowMoreLikeThisTooltipByDefault()}addToBinHandler(e){e.detail.stockItemId===this.props.stockItem.id&&(this.props.dispatch(Object(v.b)({stockItemId:this.props.stockItem.id,context:this.props.context,source:"card"})),this.props.dispatch(Object(k.g)()))}render(){const{isCollapsedStockItemLoadMoreCard:e,stockItem:t,stockItemFormats:s,style:o}=this.props;return l.a.createElement("section",{className:this.getContainerClassNames(),"data-num-format-options":s.length,"data-stock-id":t.id,ref:this.containerRef,onMouseEnter:this.handleIsHovering,onMouseLeave:this.handleIsNotHovering,style:o},e?this.renderCollapsedStockItemLoadMoreCard():this.renderNormalStockItemCard())}renderCollapsedStockItemLoadMoreCard(){const{stockItem:e,shouldStockItemHaveNewFlag:t,handleLoadingMoreCollapsedStockItems:s}=this.props;return l.a.createElement("div",{onClick:s},l.a.createElement("div",{className:"box thumbnail faded load-more"},l.a.createElement(D.a,{showNewFlag:t}),l.a.createElement("img",{className:"img-responsive progress-background thumbnail-img shrinking main-img",src:e.thumbnailUrl,alt:e.title,loading:"eager"})),l.a.createElement("h4",{className:"faded-thumbnail-text"},"Load More"))}renderNormalStockItemCard(){const{minimize:e,shouldStockItemHaveNewFlag:t,stockItem:s,imgWrapperClassNames:o}=this.props,{isHovering:a}=this.state,r=o.concat(["thumbnail-img-wrapper","overflow-hidden"]);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"box top-level-li","data-stock-id":s.id},l.a.createElement("div",{className:i()(r)},l.a.createElement(D.a,{showNewFlag:t}),this.renderStockItemFormatSelector(),this.renderSelectCheckbox(),this.getDetailLink()),!e&&this.renderButtons(),this.shouldShowCollapsedContentUI()&&this.renderBurstEffect()),a&&this.renderActionButtons())}renderSelectCheckbox(){if(this.props.context&&this.props.context.startsWith("Folder-"))return l.a.createElement("input",{type:"checkbox",className:"select-checkbox",onChange:this.onSelectCheckboxClick,checked:!!this.props.checked})}renderStockItemFormatSelector(){if(!this.props.formatSelectorVisible)return;const{formatSelectorVisible:e,stockItemFormats:t,selectedFormatName:s,selectedFormatResolution:o}=this.props;return l.a.createElement(P.a,{isVisible:e,stockItemFormats:t,selectedFormatName:s,selectedFormatResolution:o,selectedFormatChanged:(e,t)=>this.handleSelectedFormatChanged(e,t)})}getContainerClassNames(){return i()(this.props.containerResponsiveClassNames,this.props.classNames,{"stock-item-v2":!0,"stock-item":!0,"is-selected":this.props.isSelected,"download-format-selector-visible":this.props.formatSelectorVisible,"hidden-sm":this.props.hideOnThreeColumnLayout,"hidden-md":this.props.hideOnThreeColumnLayout,"collapsed-card":this.shouldShowCollapsedContentUI()})}getDetailLink(){const e=this.props.imgClassNames.concat(["main-img",this.state.imgOrientationCSSClass]);return l.a.createElement("a",{href:this.props.stockItem.detailsUrl,onTouchEnd:this.handleOnTouchEnd},l.a.createElement("img",{src:this.getThumbnailImageUrl(),alt:this.props.stockItem.title,className:i()(e),onLoad:this.setImgOrientationIfNecessary,ref:"previewImage",loading:this.props.lazyLoad?"lazy":"eager"}))}renderButtons(){const{formatSelectorVisible:e}=this.props;return e?l.a.createElement("div",{className:"controls"},l.a.createElement(N.a,{onPrimaryActionClicked:this.getPrimaryClickAction(),onSecondaryActionClicked:this.hideDownloadButtons(),showCancelLabel:this.props.formatSelectorVisible,redirectToSignUpLink:this.props.redirectToSignUpLink,detailsUrl:this.props.stockItem.detailsUrl,stockItemId:this.props.stockItem.id,selectedFormat:this.getSelectedFormat()})):null}hideDownloadButtons(){return e=>{e.preventDefault(),this.props.dispatch(Object(F.l)({formatSelectorVisible:!1})),this.setState({isHovering:!0})}}renderActionButtons(){return l.a.createElement("div",{className:"action-buttons right-3 top-2 space-y-1"},this.getDownloadButton(),this.props.shouldShowAddToFavorites&&this.getFavoriteButton(),this.shouldShowMakerButton()&&this.getMakerButton(),this.shouldShowCollapsedContentUI()&&this.getSimilarButton())}getDownloadButton(){const{shouldShowDownloadButton:e,shouldShowUpdatedClipPreviews:t}=this.props;if(!1===e)return;const s=t?"clipPreviewTest":"";return l.a.createElement("div",null,l.a.createElement(y.a,{placement:"left",popperClasses:"px-2 py-1 text-white bg-black rounded opacity-90 text-sm",showContent:this.state.showDownloadTooltip,triggerElement:e=>l.a.createElement("div",{className:"action-wrapper download-button action-download cursor-pointer "+s,ref:e,onClick:this.getPrimaryClickAction(),onMouseEnter:()=>this.setState({showDownloadTooltip:!0}),onMouseLeave:()=>this.setState({showDownloadTooltip:!1})},l.a.createElement(h.i,{className:"action-icon",color:"#FFF"}))},l.a.createElement("div",{id:"tooltip-download"},this.isASubscriptionlessUser()?"Download Preview":"Download")))}isASubscriptionlessUser(){return this.props.user.isLoggedIn&&!this.props.user.imageSubscription}getFavoriteButton(){const e=this.props.shouldShowUpdatedClipPreviews?"clipPreviewTest":"",t=this.props.bins?Object.values(this.props.bins):[],s=Object(T.s)(t,this.props.stockItem.id)?"Added to Folder":"Add to Folder";return l.a.createElement("div",null,l.a.createElement(y.a,{placement:"left",popperClasses:"px-2 py-1 text-white bg-black rounded opacity-90 text-sm",showContent:this.state.showFavoriteTooltip,triggerElement:t=>l.a.createElement("div",{className:"action-wrapper "+e,ref:t,onMouseEnter:()=>this.setState({showFavoriteTooltip:!0}),onMouseLeave:()=>this.setState({showFavoriteTooltip:!1})},l.a.createElement(I.a,{onButtonClick:()=>this.setState({showFavoriteTooltip:!1}),onClickAction:this.handleClickAction,stockItem:this.props.stockItem,stockItemFormats:this.props.stockItemFormats,telemetryKey:"search",iconClassName:"p-1.5 w-5 h-5"}))},l.a.createElement("div",{id:"tooltip-favorite",className:"whitespace-nowrap"},""+s)))}shouldShowMakerButton(){return"photo"===this.props.stockItem.contentType&&!this.props.isMobile}getMakerButton(){const{shouldShowUpdatedClipPreviews:e,stockItem:t,user:s}=this.props;return l.a.createElement(C.a,{mediaType:"image",shouldShowUpdatedClipPreviews:e,stockItemId:t.id,userIsLoggedIn:s.isLoggedIn})}getMakerUrl(e,t){return e+"?imageIds="+t}getSimilarButton(){const e=this.props.shouldShowUpdatedClipPreviews?"clipPreviewTest":"";return l.a.createElement("div",null,l.a.createElement(y.a,{placement:"left",popperClasses:"px-2 py-1 text-white bg-black rounded opacity-90 text-sm",showContent:this.state.showMoreLikeThisTooltip,triggerElement:t=>l.a.createElement("div",{className:"action-wrapper download-button action-download "+e,ref:t,onMouseEnter:()=>this.setState({showMoreLikeThisTooltip:!0}),onMouseLeave:()=>this.setState({showMoreLikeThisTooltip:!1})},l.a.createElement("div",{className:"action-wrapper similar-button "+e},l.a.createElement("img",{alt:"More like this icon",className:"action-icon",onClick:this.getSimilarContentAction,src:"/assets/common/images/icons/stock-item-cards/sb-video-similar.svg"})))},l.a.createElement("div",{id:"tooltip-similar",className:"whitespace-nowrap"},"More Like This")))}shouldShowMoreLikeThisTooltipByDefault(){const e=d.a.load("morelikethis"),t=window&&window.location&&"."+window.location.hostname;e||(d.a.save("morelikethis",!0,{path:"/",domain:t}),this.setState({showMoreLikeThisTooltip:!0})),this.setState({showMoreLikeThisTooltip:!1})}stockItemHasAspectRatio(){const e=this.props.stockItem;return"aspectRatio"in e&&e.aspectRatio}useSmallerThumbnailImage(){return this.stockItemHasAspectRatio()&&this.props.stockItem.aspectRatio<2}getThumbnailImageUrl(){return this.props.stockItem.thumbnailUrl&&this.props.stockItem.smallPreviewUrl?this.useSmallerThumbnailImage()?this.props.stockItem.thumbnailUrl:this.props.stockItem.smallPreviewUrl:this.props.stockItem.smallPreviewUrl||this.props.stockItem.thumbnailUrl}getPrimaryClickAction(){if(this.isASubscriptionlessUser()){const e=Object(u.b)(this.props.stockItem.id,u.e);return()=>{m.Telemetry.increment("preview.downloaded.stockItemCard"),e()}}return this.getRedirectPage()?e=>{e.preventDefault(),this.logPrimaryClickAction(),window.location.href=this.getRedirectPage()}:this.getDefaultPrimaryClickAction()}getDefaultPrimaryClickAction(){return e=>{if(this.logPrimaryClickAction(),!this.overrideClickActionsForRedirect())if(e.preventDefault(),!this.props.formatSelectorVisible&&this.props.stockItemFormats.length>=2)this.primaryActionUpdateSelectedStockItemOption();else{const e=this.getSelectedFormat();this.primaryActionDownloadItem(e)}}}getSelectedFormat(){const{stockItemFormats:e,selectedFormatName:t,selectedFormatResolution:s}=this.props;return e.length>=2?e.find(e=>e.formatName===t&&e.resolution===s):this.props.stockItemFormats[0]}overrideClickActionsForRedirect(){return this.props.redirectToSignUpLink}primaryActionUpdateSelectedStockItemOption(){this.setState({isHovering:!1}),this.props.dispatch(Object(F.l)({id:this.props.stockItem.id,formatSelectorVisible:!0,selectedFormatName:this.props.stockItemFormats[0].formatName,selectedFormatResolution:this.props.stockItemFormats[0].resolution}))}logPrimaryClickAction(){const{stockItem:e,stockItemCardContext:t}=this.props;f.a.produceDownloadClickEvent(e,t&&t.position)}primaryActionDownloadItem(e){const{imageSubscription:t,primarySubscription:s}=this.props.user;m.Telemetry.increment("download.clicked.stockItemCard"),S.e.buildInstance().getDataBridge().downloadItem(e.downloadUrl,e.downloadAjaxUrl,this.props.searchLogParameters,this.props.dispatch,s||t,this.plansAndPricingUpgradeAvailable())}getRedirectPage(){let e=null;return this.props.user.imageSubscription||(e=this.props.stockItem.detailsUrl),e}plansAndPricingUpgradeAvailable(){return!!this.props.plansAndPricingUpgradeInfo}renderBurstEffect(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"first-shadow"}),l.a.createElement("div",{className:"second-shadow"}))}shouldShowCollapsedContentUI(){return this.props.stockItem.numCollapses>2&&"search"===this.props.context}}U(L,"propTypes",{stockItem:E.a.stockItem,stockItemFormats:r.a.arrayOf(E.a.stockItemFormat).isRequired,isSelected:r.a.bool,searchLogParameters:r.a.object,minimize:r.a.bool,containerResponsiveClassNames:r.a.arrayOf(r.a.string),hideOnThreeColumnLayout:r.a.bool,style:r.a.object,classNames:r.a.arrayOf(r.a.string),imgClassNames:r.a.arrayOf(r.a.string),imgWrapperClassNames:r.a.arrayOf(r.a.string),shouldShowAddToFavorites:r.a.bool,checked:r.a.bool,page:r.a.number,context:r.a.string,stockItemCardContext:r.a.object,user:r.a.object,shouldStockItemHaveNewFlag:r.a.bool,isCollapsedStockItemLoadMoreCard:r.a.bool,handleLoadingMoreCollapsedStockItems:r.a.func,shouldShowDownloadButton:r.a.bool,lazyLoad:r.a.bool}),U(L,"defaultProps",{containerResponsiveClassNames:["col-lg-3 ","col-md-4 ","col-sm-4 ","col-xs-10 ","col-xs-offset-1 ","col-lg-offset-0 ","col-md-offset-0 ","col-sm-offset-0"],style:{},classNames:[],imgClassNames:[],imgWrapperClassNames:[],isCollapsedStockItemLoadMoreCard:!1,lazyLoad:!0}),t.a=Object(p.c)((function(e,t){const{app:s,details:o,memberBin:i}=e,a=s.search,{selectedStockItem:r}=a,n=r.id===t.stockItem.id,l=a.features.abTests&&a.features.abTests.clipPreviews&&a.features.abTests.clipPreviews.shouldShowUpdatedClipPreviews||o.features.abTests&&o.features.abTests.clipPreviews&&o.features.abTests.clipPreviews.shouldShowUpdatedClipPreviews||i.features.abTests&&i.features.abTests.clipPreviews&&i.features.abTests.clipPreviews.shouldShowUpdatedClipPreviews;return{formatSelectorVisible:!!n&&r.formatSelectorVisible,selectedFormatName:n?r.selectedFormatName:null,selectedFormatResolution:n?r.selectedFormatResolution:null,selectedSearchFilterOptions:a.selectedSearchFilterOptions,signUpLink:a.features.signUpLink,redirectToSignUpLink:a.features.redirectToSignUpLink,bmtTestSegmentName:a.features.bmtTestSegmentName,plansAndPricingUpgradeInfo:e.popUps.instanceSpecificInfo.plansAndPricingUpgradeInfo,bins:e.memberBins.bins,drawerIsOpen:a.drawerIsOpen,drawerSelectedItemId:a.drawerSelectedItemId,user:e.auth,shouldShowUpdatedClipPreviews:l}}))(L)},294:function(e,t,s){"use strict";var o=s(6),i=s.n(o),a=s(1),r=s.n(a),n=s(0),l=s.n(n),c=s(150),d=s.n(c),p=s(2),h=s(10),m=s(9),u=s(59),g=s(389),w=s(12),k=s(319),v=s(646),b=s(129);var f=s(96),S=s(25),I=s(56),C=s(390),y=s(141),T=s(7),F=s(157),E=s(210),N=s(168),P=s(320),D=s(51),U=s(5),L=s(8),M=s(139),A=s(525),O=s(99),x=s(526);class R extends x.a{componentDidMount(){const e=this.props.downloadPermissions&&!1===this.props.downloadPermissions.fourK,t="4K"===this.props.stockItemFormats[0].quality;(e||t)&&this.selectHDOption()}selectHDOption(){const e=this.props.stockItemFormats.find(e=>"HD"===e.quality);e&&this.props.selectedFormatChanged(e.formatName,e.resolution)}}var B=R;function j(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class H extends n.Component{constructor(e){super(e),j(this,"handleMouseEnter",()=>{this.handleIsHovering(),this.play()}),j(this,"handleIsHovering",()=>{this.props.formatSelectorVisible||(this.setState({isHovering:!0,hoverStartTime:Date.now()}),this.props.page&&this.props.dispatch(Object(L.s)(this.props.page,this.props.stockItem.id)))}),j(this,"handleStockItemClick",e=>{"VIDEO"===e.target.nodeName&&this.logHoverDone()}),j(this,"handleMouseLeave",e=>{var t,s,o,i,a,r;null!=e&&null!==(t=e.relatedTarget)&&void 0!==t&&null!==(s=t.className)&&void 0!==s&&null!==(o=s.includes)&&void 0!==o&&o.call(s,"tooltip")||null!=e&&null!==(i=e.target)&&void 0!==i&&null!==(a=i.className)&&void 0!==a&&null!==(r=a.includes)&&void 0!==r&&r.call(a,"action-icon")||(this.handleIsNotHovering(),this.pause())}),j(this,"handleIsNotHovering",()=>{this.setState({isHovering:!1,playStartTime:null,accumulatedPlayMs:this.state.accumulatedPlayMs+this.playDurationMs()}),this.logHoverDone()}),j(this,"handleClickAction",e=>{Object(U.r)((null==e?void 0:e.nativeEvent)||e,this.containerRef.current)||this.handleMouseLeave(e)}),j(this,"handleSelectedFormatChanged",(e,t)=>{this.props.dispatch(Object(L.l)({id:this.props.stockItem.id,selectedFormatName:e,selectedFormatResolution:t}))}),j(this,"hideDownloadButtons",e=>{e.preventDefault(),this.props.dispatch(Object(L.l)({formatSelectorVisible:!1})),this.setState({isHovering:!0})}),j(this,"handleVideoStartedPlaying",()=>{this.setState({isPlaying:!0,playStartTime:this.state.playStartTime||Date.now()})}),j(this,"handleOnTouchEnd",()=>{const{isDragging:e}=this.state;if(!e){const{detailsUrl:e}=this.props.stockItem;window.location.href=e}}),j(this,"getSimilarContentAction",()=>{const{selectedSearchFilterOptions:e,drawerIsOpen:t,drawerSelectedItemId:s,stockItem:o,dispatch:i}=this.props;if(t&&s===o.id)i(Object(L.d)());else{const{collapsedSetId:t,id:s}=o,a={collapsedSetId:t,id:s,excludeStockItemIds:o.id,page:1},r=e.update(a);i(Object(L.f)(r)),i(Object(L.e)(s))}}),j(this,"deleteFromFolder",()=>{this.props.dispatch(Object(f.b)(this.props.binUniqueId,[this.props.stockItem.id]))}),this.state={accumulatedPlayMs:0,isDragging:!1,isHovering:!1,isPlaying:!1,playPromiseProcessing:!1,showDeleteTooltip:!1,showDownloadTooltip:!1,showFavoriteTooltip:!1,showMoreLikeThisTooltip:!1},this.containerRef=Object(n.createRef)(),this.videoRef=Object(n.createRef)()}componentDidMount(){this.containerRef.current.addEventListener("touchmove",()=>{this.state.isDragging||this.setState({isDragging:!0})}),this.containerRef.current.addEventListener("touchstart",()=>{this.state.isDragging&&this.setState({isDragging:!1})}),window.addEventListener("addToBin",this.addToBinHandler.bind(this)),Object(C.a)(this.containerRef.current,()=>{const e=this.props.stockItemCardContext||{};e.position&&g.a.push(k.a.displayedStockItem(this.props.stockItem,e.position))}),this.shouldShowMoreLikeThisTooltipByDefault()}addToBinHandler(e){e.detail.stockItemId===this.props.stockItem.id&&(this.props.dispatch(Object(I.b)({stockItemId:this.props.stockItem.id,context:this.props.context,source:"card"})),this.props.dispatch(Object(S.g)()))}render(){const{isCollapsedStockItemLoadMoreCard:e,stockItem:t,style:s}=this.props;return l.a.createElement("div",{className:this.getContainerClassNames(),"data-stock-id":t.id,ref:this.containerRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleStockItemClick,style:s},e?this.renderCollapsedStockItemLoadMoreCard():this.renderNormalStockItemCard())}renderCollapsedStockItemLoadMoreCard(){const{handleLoadingMoreCollapsedStockItems:e,shouldShowUpdatedClipPreviews:t,shouldStockItemHaveNewFlag:s,stockItem:o,thumbnailClassNames:i}=this.props,{isHovering:a}=this.state,r=t?!a&&s:s,n=t?"clipPreviewTest":"";return l.a.createElement("div",{onClick:e},l.a.createElement("div",{className:"box thumbnail faded load-more "+i},l.a.createElement(O.a,{showNewFlag:r}),l.a.createElement("img",{className:"action-icon thumbnail-img",src:o.thumbnailUrl,alt:o.title,loading:"eager"}),l.a.createElement("div",{className:"controls "+n},this.renderStockItemTitle(n))),l.a.createElement("h4",{className:"faded-thumbnail-text"},"Load More"))}renderNormalStockItemCard(){const{draggableCard:e,formatSelectorVisible:t,shouldShowUpdatedClipPreviews:s,shouldStockItemHaveNewFlag:o,thumbnailClassNames:i}=this.props,{isHovering:a,isPlaying:r}=this.state,n=s?!a&&o:o;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"box thumbnail"},l.a.createElement("div",{className:"thumbnail-img-wrapper overflow-hidden "+i},t&&this.renderStockItemFormatSelector(),l.a.createElement(O.a,{showNewFlag:n}),e?this.renderVideo():this.renderVideoWithDetailsLink(),l.a.createElement(N.a,{show:a&&!r})),this.renderButtons(),this.shouldShowCollapsedContentUI()&&this.renderBurstEffect()),a&&this.renderActionButtons())}play(){if(this.videoRef&&this.videoRef.current){const e=this.videoRef.current.videoRef.current.play();this.setState({playPromiseProcessing:!0}),e&&e.then(()=>{this.setState({playPromiseProcessing:!1}),this.state.isHovering||this.pause()}).catch(e=>{this.setState({playPromiseProcessing:!1}),e instanceof DOMException&&"AbortError"===e.name||(this.state.isHovering&&this.play(),console.error("Playback exception: ",{name:e.name,errorType:e}))})}}pause(){this.videoRef&&this.videoRef.current&&!this.state.playPromiseProcessing&&this.videoRef.current.videoRef.current.pause()}renderStockItemFormatSelector(){return l.a.createElement(B,{isVisible:this.props.formatSelectorVisible,stockItemFormats:this.props.stockItemFormats,selectedFormatName:this.props.selectedFormatName,selectedFormatResolution:this.props.selectedFormatResolution,selectedFormatChanged:(e,t)=>this.handleSelectedFormatChanged(e,t),downloadPermissions:this.props.downloadPermissions})}renderActionButtons(){return l.a.createElement("div",{className:"action-buttons right-2 space-y-1"},this.getDownloadButton(),this.props.shouldShowAddToFavorites&&this.getFavoriteButton(),this.getDeleteButton(),this.shouldShowMakerButton()&&this.getMakerButton(),this.shouldShowCollapsedContentUI()&&this.getSimilarButton())}renderButtons(){const{formatSelectorVisible:e,shouldShowDownloadButton:t,shouldShowUpdatedClipPreviews:s,shouldInvertControlsVisibility:o}=this.props,{isHovering:i}=this.state,a=!e&&s?"clipPreviewTest":"",r=o?"":"bg-transparent",n=o?"bg-transparent":"";return l.a.createElement("div",{className:`controls ${a} ${i?r:n}`},this.renderStockItemTitle(a),e&&t&&l.a.createElement(A.a,{onPrimaryActionClicked:this.getPrimaryClickAction(),onSecondaryActionClicked:this.hideDownloadButtons,showCancelLabel:this.props.formatSelectorVisible,redirectToSignUpLink:this.props.redirectToSignUpLink,detailsUrl:this.props.stockItem.detailsUrl,stockItemId:this.props.stockItem.id,selectedFormat:this.getSelectedFormat()}))}renderStockItemTitle(e=""){const{shouldInvertControlsVisibility:t}=this.props,{duration:s,title:o}=this.props.stockItem,i=t?"opacity-100":"opacity-0",a=t?"opacity-0":"opacity-100";return l.a.createElement("div",{className:`item-title ${e} ${this.state.isHovering?i:a}`},l.a.createElement("p",null,o),s?l.a.createElement(F.a,{seconds:s}):null)}renderBurstEffect(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"first-shadow"}),l.a.createElement("div",{className:"second-shadow"}))}shouldShowMakerButton(){const{stockItem:e}=this.props;return!("footage"!==e.contentType&&"motionbackground"!==e.contentType||e.is360||this.props.isMobile)}shouldShowCollapsedContentUI(){return this.props.stockItem.numCollapses>2&&"search"===this.props.context}playDurationMs(){return this.state.playStartTime?Date.now()-this.state.playStartTime:0}logHoverDone(){if(this.state.hoverStartTime){const e=Date.now()-this.state.hoverStartTime,t=this.videoRef.current.videoRef.current.currentTime,s=this.state.accumulatedPlayMs+this.playDurationMs(),o=Math.floor(s/1e3/this.props.stockItem.duration),i=class{static create(e,t,s,o,i,a,r=Date.now()){const n=new v.StockItemHoverEvent,l=s?r-s:0;return n.meta=w.a.meta(),n.device=w.a.device(),n.user=w.a.user(),n.searchIdentifiers=w.a.getSearchIdentifiers(),n.stockItem=b.a.create(e),n.hoverStart=t,n.hoverEnd=r,n.playEnd=Math.floor(o),n.timesLooped=i,n.playStart=s?Math.ceil(n.playEnd-l/1e3+i*e.duration):0,n.urls=w.a.urls(),n}}.create(this.props.stockItem,this.state.hoverStartTime,this.state.playStartTime,t,o,s);e>1e3&&w.a.produce(i,i.user.visitorCookieId)}}primaryActionDownloadItem(e){const{primarySubscription:t,videoSubscription:s}=this.props.user;m.Telemetry.increment("download.clicked.stockItemCard"),T.e.buildInstance().getDataBridge().downloadItem(e.downloadUrl,e.downloadAjaxUrl,this.props.searchLogParameters,this.props.dispatch,t||s,this.plansAndPricingUpgradeAvailable())}renderVideoWithDetailsLink(){return l.a.createElement("a",{className:"image-link",href:this.props.stockItem.detailsUrl,onTouchEnd:this.handleOnTouchEnd,"aria-label":"Go to video details for "+this.props.stockItem.title},this.renderVideo())}renderVideo(){const{stockItem:e}=this.props;return l.a.createElement(h.r,{ref:this.videoRef,videoUrl:e.previewUrl,poster:e.thumbnailUrl,onStartedPlaying:this.handleVideoStartedPlaying,autoPlay:!1,preload:!1,mute:!0})}getPrimaryClickAction(){const{stockItem:e,user:t}=this.props;if(this.isASubscriptionlessUser()){const t=Object(u.b)(e.id,u.e);return()=>{m.Telemetry.increment("preview.downloaded.stockItemCard"),t()}}if(e&&!t.videoSubscription){const t=e.detailsUrl;return e=>{e.preventDefault(),this.logPrimaryClickAction(),window.location.href=t}}return this.getDefaultPrimaryClickAction()}getDefaultPrimaryClickAction(){return e=>{if(this.logPrimaryClickAction(),!this.overrideClickActionsForRedirect())if(e.preventDefault(),!this.props.formatSelectorVisible&&this.props.stockItemFormats.length>=2)this.primaryActionUpdateSelectedStockItemOption();else{const e=this.getSelectedFormat();this.primaryActionDownloadItem(e)}}}getSelectedFormat(){const{stockItemFormats:e,selectedFormatName:t,selectedFormatResolution:s}=this.props;return e.length>=2&&t?e.find(e=>e.formatName===t&&e.resolution===s):e[0]}overrideClickActionsForRedirect(){return this.props.redirectToSignUpLink}primaryActionUpdateSelectedStockItemOption(){this.setState({isHovering:!1,isPlaying:!1}),this.props.dispatch(Object(L.l)({id:this.props.stockItem.id,formatSelectorVisible:!0,selectedFormatName:this.props.stockItemFormats[0].formatName,selectedFormatResolution:this.props.stockItemFormats[0].resolution}))}logPrimaryClickAction(){const{stockItem:e,stockItemCardContext:t}=this.props;y.a.produceDownloadClickEvent(e,t&&t.position),this.logHoverDone()}plansAndPricingUpgradeAvailable(){return!!this.props.plansAndPricingUpgradeInfo}getContainerClassNames(){return i()(this.props.containerResponsiveClassNames,this.props.classNames,{"stock-item":!0,"stock-item-v2":!0,"is-selected":this.props.isSelected,"download-format-selector-visible":this.props.formatSelectorVisible,"hidden-sm":this.props.hideOnThreeColumnLayout,"hidden-md":this.props.hideOnThreeColumnLayout,"collapsed-card":this.shouldShowCollapsedContentUI()})}getDownloadButton(){const{shouldShowDownloadButton:e,shouldShowUpdatedClipPreviews:t}=this.props;if(!1===e)return;const s=t?"clipPreviewTest":"";return l.a.createElement("div",null,l.a.createElement(D.a,{placement:"left",popperClasses:"px-2 py-1 text-white bg-black rounded opacity-90 text-sm",showContent:this.state.showDownloadTooltip,triggerElement:e=>l.a.createElement("div",{className:"action-wrapper download-button action-download "+s,ref:e,onClick:this.getPrimaryClickAction(),onMouseEnter:()=>this.setState({showDownloadTooltip:!0}),onMouseLeave:()=>this.setState({showDownloadTooltip:!1})},l.a.createElement(h.i,{className:"action-icon",color:"#FFF"}))},l.a.createElement("div",{id:"tooltip-download"},this.isASubscriptionlessUser()?"Download Preview":"Download")))}isASubscriptionlessUser(){return this.props.user.isLoggedIn&&!this.props.user.videoSubscription}getFavoriteButton(){const{shouldShowUpdatedClipPreviews:e,stockItem:t,stockItemFormats:s}=this.props,o=e?"clipPreviewTest":"",i=this.props.bins?Object.values(this.props.bins):[],a=Object(U.s)(i,this.props.stockItem.id)?"Added to Folder":"Add to Folder";return l.a.createElement("div",null,l.a.createElement(D.a,{placement:"left",popperClasses:"px-2 py-1 text-white bg-black rounded opacity-90 text-sm",showContent:this.state.showFavoriteTooltip,triggerElement:e=>l.a.createElement("div",{className:"action-wrapper "+o,ref:e,onMouseEnter:()=>this.setState({showFavoriteTooltip:!0}),onMouseLeave:()=>this.setState({showFavoriteTooltip:!1})},l.a.createElement(E.a,{onButtonClick:()=>this.setState({showFavoriteTooltip:!1}),onClickAction:this.handleClickAction,stockItem:t,stockItemFormats:s,telemetryKey:"search",iconClassName:"p-1.5 w-5 h-5"}))},l.a.createElement("div",{id:"tooltip-favorite",className:"whitespace-nowrap"},""+a)))}getDeleteButton(){if(!1===this.props.shouldShowDeleteButton)return;const e=this.props.shouldShowUpdatedClipPreviews?"clipPreviewTest":"";return l.a.createElement("div",null,l.a.createElement(D.a,{placement:"left",popperClasses:"px-2 py-1 text-white bg-black rounded opacity-90 text-sm",showContent:this.state.showDeleteTooltip,triggerElement:t=>l.a.createElement("div",{className:"action-wrapper download-button action-download "+e,ref:t,onMouseEnter:()=>this.setState({showDeleteTooltip:!0}),onMouseLeave:()=>this.setState({showDeleteTooltip:!1})},l.a.createElement("div",{className:"action-wrapper "+e},l.a.createElement("img",{alt:"Delete from folder icon",src:__ASSETS_COMMON_IMAGES_URL__+"/member/folders/trash-with-padding.svg",className:"stockItemCard-deleteButton action-icon",onClick:this.deleteFromFolder})))},l.a.createElement("div",{id:"tooltip-delete"},"Delete From Folder")))}getMakerButton(){const{shouldShowUpdatedClipPreviews:e,stockItem:t,user:s}=this.props;return l.a.createElement(P.a,{mediaType:"video",shouldShowUpdatedClipPreviews:e,stockItemId:t.id,userIsLoggedIn:s.isLoggedIn})}getSimilarButton(){const e=this.props.shouldShowUpdatedClipPreviews?"clipPreviewTest":"";return l.a.createElement("div",null,l.a.createElement(D.a,{placement:"left",popperClasses:"px-2 py-1 text-white bg-black rounded opacity-90 text-sm",showContent:this.state.showMoreLikeThisTooltip,triggerElement:t=>l.a.createElement("div",{className:"action-wrapper download-button action-download "+e,ref:t,onMouseEnter:()=>this.setState({showMoreLikeThisTooltip:!0}),onMouseLeave:()=>this.setState({showMoreLikeThisTooltip:!1})},l.a.createElement("div",{className:"action-wrapper similar-button "+e},l.a.createElement("img",{alt:"More like this icon",className:"action-icon",onClick:this.getSimilarContentAction,src:"/assets/common/images/icons/stock-item-cards/sb-video-similar.svg"})))},l.a.createElement("div",{id:"tooltip-similar",className:"whitespace-nowrap"},"More Like This")))}shouldShowMoreLikeThisTooltipByDefault(){const e=d.a.load("morelikethis"),t=window&&window.location&&"."+window.location.hostname;e||(d.a.save("morelikethis",!0,{path:"/",domain:t}),this.setState({showMoreLikeThisTooltip:!0})),this.setState({showMoreLikeThisTooltip:!1})}}j(H,"propTypes",{binUniqueId:r.a.string,classNames:r.a.arrayOf(r.a.string),containerResponsiveClassNames:r.a.arrayOf(r.a.string),context:r.a.string,draggableCard:r.a.bool,handleLoadingMoreCollapsedStockItems:r.a.func,hideOnThreeColumnLayout:r.a.bool,isCollapsedStockItemLoadMoreCard:r.a.bool,isSelected:r.a.bool,page:r.a.number,searchLogParameters:r.a.object,shouldInvertControlsVisibility:r.a.bool,shouldShowAddToFavorites:r.a.bool,shouldShowDeleteButton:r.a.bool,shouldShowDownloadButton:r.a.bool,shouldShowUpdatedClipPreviews:r.a.bool,shouldStockItemHaveNewFlag:r.a.bool,stockItem:M.a.stockItem,stockItemCardContext:r.a.object,stockItemFormats:r.a.arrayOf(M.a.stockItemFormat).isRequired,style:r.a.object,thumbnailClassNames:r.a.string,user:r.a.object}),j(H,"defaultProps",{classNames:[],containerResponsiveClassNames:["relative","float-left","w-5/6","md:w-1/3","lg:w-1/4"],draggableCard:!1,isCollapsedStockItemLoadMoreCard:!1,shouldShowAddToFavorites:!0,shouldShowDownloadButton:!0,shouldShowDeleteButton:!1,shouldInvertControlsVisibility:!1,style:{},thumbnailClassNames:""});t.a=Object(p.c)((function(e,t){const{app:s,details:o,memberBin:i}=e,a=s.search,{selectedStockItem:r}=a,n=r.id===t.stockItem.id,l=a.features.abTests&&a.features.abTests.clipPreviews&&a.features.abTests.clipPreviews.shouldShowUpdatedClipPreviews||o.features.abTests&&o.features.abTests.clipPreviews&&o.features.abTests.clipPreviews.shouldShowUpdatedClipPreviews||i.features.abTests&&i.features.abTests.clipPreviews&&i.features.abTests.clipPreviews.shouldShowUpdatedClipPreviews;return{formatSelectorVisible:!!n&&r.formatSelectorVisible,selectedFormatName:n?r.selectedFormatName:null,selectedFormatResolution:n?r.selectedFormatResolution:null,signUpLink:e.details.features.signUpLink||a.features.signUpLink,plansAndPricingUpgradeInfo:e.popUps.instanceSpecificInfo.plansAndPricingUpgradeInfo,drawerIsOpen:a.drawerIsOpen,drawerSelectedItemId:a.drawerSelectedItemId,selectedSearchFilterOptions:a.selectedSearchFilterOptions,bins:e.memberBins.bins,downloadPermissions:a.features.downloadPermissions,user:e.auth,shouldShowUpdatedClipPreviews:l}}))(H)},525:function(e,t,s){"use strict";var o=s(1),i=s.n(o),a=s(0),r=s.n(a),n=s(10),l=s(4),c=s(51);const d=e=>{const{detailsUrl:t,onPrimaryActionClicked:s,onSecondaryActionClicked:o,redirectToSignUpLink:i,showCancelLabel:d}=e,[p,h]=Object(a.useState)(!1),[m,u]=Object(a.useState)(!1),g=()=>i?"/join/register":t;return r.a.createElement("div",{className:"absolute z-50 block w-full h-full p-0 opacity-100"},r.a.createElement(c.a,{showContent:p,placement:"top",popperClasses:"bg-white rounded",triggerElement:e=>r.a.createElement("a",{className:"download-trigger hover:text-black focus:text-black hover:bg-yellow-500 focus::bg-yellow-500 inline-flex items-center justify-center w-1/2 h-full p-0 m-0 text-center text-white align-middle bg-black border-none cursor-pointer","data-promo-context":l.e.cardDownload,href:g(),onClick:s,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),ref:e},r.a.createElement(n.i,{className:"download-icon fill-current",color:"null"}))},r.a.createElement("div",{id:"tooltip-download",className:"p-1 text-xs"},"Download")),r.a.createElement(c.a,{showContent:m,placement:"top",popperClasses:"bg-white rounded",triggerElement:e=>r.a.createElement("a",{className:"hover:text-black focus:text-black hover:bg-yellow-500 focus:bg-yellow-500 hover:no-underline focus:no-underline inline-flex items-center justify-center w-1/2 h-full p-0 m-0 text-center text-white align-middle bg-black border-none cursor-pointer","data-promo-context":l.e.cardDownload,href:g(),onClick:o,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),ref:e},r.a.createElement("i",{className:"fa fa-times"}))},r.a.createElement("div",{id:"tooltip-download",className:"p-1 text-xs"},d?"Cancel":"Add to Folder")))};d.propTypes={detailsUrl:i.a.string,onPrimaryActionClicked:i.a.func.isRequired,onSecondaryActionClicked:i.a.func.isRequired,redirectToSignUpLink:i.a.bool,showCancelLabel:i.a.bool.isRequired},d.defaultProps={detailsUrl:"",redirectToSignUpLink:!1},t.a=d},526:function(e,t,s){"use strict";var o,i,a,r=s(6),n=s.n(r),l=s(1),c=s.n(l),d=s(0),p=s.n(d),h=s(139);class m extends d.Component{render(){const e=n()({"download-format-selector":!0,view:this.props.isVisible}),t=n()({"download-formats":!0,"download-formats-long":this.props.stockItemFormats.length>2});return p.a.createElement("div",{className:e},p.a.createElement("div",{className:t},p.a.createElement("strong",null,this.getTitle(),":"),this.renderFormatsList()))}renderFormatsList(){return this.props.stockItemFormats.map(e=>p.a.createElement("div",{className:"download-format-option",key:e.formatName},p.a.createElement("input",{id:"stockItemFormat"+e.formatName,type:"radio",value:e.formatName,checked:this.props.selectedFormatName==e.formatName&&this.props.selectedFormatResolution==e.resolution,onChange:t=>this.props.selectedFormatChanged(e.formatName,e.resolution),"data-extension":e.fileExtension||""}),p.a.createElement("label",{htmlFor:"stockItemFormat"+e.formatName},this.getTitleForStockFormat(e))))}getTitle(){return"Choose a format"}getTitleForStockFormat(e){let t=e.label;return e.codec&&(t+=` (${e.codec})`),`${t} - ${e.filesize}`}}o=m,i="propTypes",a={isVisible:c.a.bool.isRequired,stockItemFormats:c.a.arrayOf(h.a.stockItemFormat).isRequired,selectedFormatName:c.a.string.isRequired,selectedFormatChanged:c.a.func.isRequired,downloadPermissions:c.a.object},i in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,t.a=m},99:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s(1),i=s(0),a=s.n(i);function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n extends i.Component{render(){const{showNewFlag:e}=this.props;return e?a.a.createElement("div",{className:"StockItemIcons"},a.a.createElement("span",{className:"StockItemIcons-newFlag"},"NEW")):null}}r(n,"propTypes",{showNewFlag:o.bool}),r(n,"defaultProps",{showNewFlag:!1})}}]);