(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{201:function(e,t,i){},226:function(e,t,i){},36:function(e,t,i){},373:function(e,t,i){},39:function(e,t,i){},41:function(e,t,i){"use strict";i(83),i(100),i(101),i(69),i(111),i(102),i(92),i(26),i(65),i(70),i(108),i(97),i(78),i(77),i(64),i(73),i(39),i(63),i(36),i(79),i(43)},43:function(e,t,i){},66:function(e,t,i){},67:function(e,t,i){},74:function(e,t,i){"use strict";var s=i(0),n=i.n(s),o=i(2),r=i(113),a=i(12),d=i(129);var p=i(4),c=i(35),u=i(11);class l extends s.Component{constructor(){var e,t,i;super(),i=(e=null,t=null)=>{const i=e||this.props,s=t||this.state,n=i.stockItem,o=s.playStartMs,p=s.playEndMs,c=Math.round(1e3*i.duration),u=p-o,l=Math.min(c,1e3);if(!(!i.isPlaying||o>p||isNaN(c)||u<l))try{const e=class{static create(e,t,i,s){const n=new r.AudioPreviewEvent;return n.meta=a.a.meta(),n.device=a.a.device(),n.user=a.a.user(),n.urls=a.a.urls(),n.searchIdentifiers=a.a.getSearchIdentifiers(),n.stockItem=d.a.create(e),n.durationMs=s,n.playStartMs=t,n.playEndMs=i,n}}.create(n,o,p,c);a.a.produce(e,e.user.visitorCookieId)}catch(e){}},(t="producePreviewEventIfPlaying")in(e=this)?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,this.state={playStartMs:0,playEndMs:0}}componentDidMount(){if("search"===this.props.context){const e=Object(c.a)("currentVolume"),t=Object(c.a)("pastVolume");this.props.dispatch(Object(u.k)(e)),this.props.dispatch(Object(u.l)(t))}this.audio.addEventListener("timeupdate",()=>{this.setState({playEndMs:Math.round(1e3*this.audio.currentTime)}),this.props.dispatch(Object(u.i)(this.audio.currentTime,this.audio.duration))}),this.audio.addEventListener("loadstart",()=>{this.props.dispatch(Object(u.h)(this.audio.src))}),this.audio.addEventListener("seeking",()=>{this.producePreviewEventIfPlaying(),this.setState({playStartMs:Math.round(1e3*this.audio.currentTime)})}),this.audio.addEventListener("playing",()=>{this.props.dispatch(Object(u.d)())}),this.audio.addEventListener("pause",()=>{this.producePreviewEventIfPlaying(),this.props.dispatch(Object(u.c)())}),this.audio.addEventListener("ended",()=>{this.props.contentTypeFilter===p.b.MUSIC&&this.playNext()}),window.onbeforeunload=()=>this.producePreviewEventIfPlaying()}componentDidUpdate(e,t){let i=!1;null!==this.props.pendingCurrentVolume&&(Object(c.e)("currentVolume",this.props.pendingCurrentVolume),this.props.dispatch(Object(u.e)(this.props.pendingCurrentVolume)),this.audio.volume=this.props.pendingCurrentVolume,i=!0),null!==this.props.pendingPastVolume&&(Object(c.e)("pastVolume",this.props.pendingPastVolume),this.props.dispatch(Object(u.g)(this.props.pendingPastVolume)),i=!0),this.props.pendingAudioSourceUrl&&this.props.audioSourceUrl!==this.props.pendingAudioSourceUrl&&(this.audio.src=this.props.pendingAudioSourceUrl,i=!0),null!==this.props.pendingCurrentTime&&this.props.pendingCurrentTime>=0&&(this.audio.currentTime=this.props.pendingCurrentTime,i=!0),this.props.pendingShouldPlay&&(this.audio.play(),i=!0),this.props.pendingShouldPause&&(this.audio.pause(),i=!0),this.props.pendingPlayNext&&(this.playNext(),i=!0),this.props.pendingPlayPrev&&(this.playPrev(),i=!0),e.stockItem&&this.props.stockItem&&e.stockItem.id!==this.props.stockItem.id&&!1!==e.isPlaying&&this.producePreviewEventIfPlaying(e,t),i&&this.props.dispatch(Object(u.b)())}async playNext(){const{searchStockItems:e}=this.props;if(e.length){const e=this.determineQueuedTrack(1);await this.playQueuedTrack(e)}}async playPrev(){const{currentTime:e,stockItem:t,stockItemArtists:i,stockItemFormats:s,searchStockItems:n}=this.props;if(n.length){const n=e>=3?{stockItem:t,stockItemArtists:i,stockItemFormats:s}:this.determineQueuedTrack(-1);await this.playQueuedTrack(n)}}async playQueuedTrack(e){const{dispatch:t,isLoggedIn:i}=this.props;let s={};try{const t=await fetch(e.stockItem.waveformUrl);s=await t.json()}catch(e){}t(Object(u.n)(e.stockItem.previewUrl,0,e.stockItem,e.stockItemArtists,e.stockItemFormats,s)),Object(c.d)(e.stockItem,i)}determineQueuedTrack(e){const{stockItem:t,filtersChanged:i}=this.props,s=this.getCombinedStockItems();if(i)return s[0];const n=s.findIndex(e=>e.stockItem.id===t.id);if(-1!==n){if(-1===e&&0===n)return s[n];const t=n+e;return t>=s.length?s[0]:s[t]}const o=s.findIndex(e=>e.stockItem.collapsedSetId===t.collapsedSetId);if(-1!==o){const t=o+e;return t>=s.length?s[0]:s[t]}return s[0]}getCombinedStockItems(){const{searchStockItems:e,collapsedSetStockItems:t,drawerIsOpen:i,drawerContentLoaded:s,drawerSelectedItemId:n}=this.props,o=[...e];if(i&&s&&n){const e=o.findIndex(e=>e.stockItem.id===n);o.splice(e+1,0,...t)}return o}render(){return n.a.createElement("audio",{id:"audio",ref:e=>this.audio=e},n.a.createElement("source",{type:"audio/mpeg",src:this.props.audioSourceUrl}))}}t.a=Object(o.c)((function(e){var t,i,s;return{isPlaying:e.audio.isPlaying,isPaused:e.audio.isPaused,audioSourceUrl:e.audio.audioSourceUrl,currentTime:e.audio.currentTime,duration:e.audio.duration,currentVolume:e.audio.currentVolume,pastVolume:e.audio.pastVolume,pendingCurrentVolume:e.audio.pending.currentVolume,pendingPastVolume:e.audio.pending.pastVolume,pendingMute:e.audio.pending.mute,pendingCurrentTime:e.audio.pending.currentTime,pendingAudioSourceUrl:e.audio.pending.audioSourceUrl,pendingShouldPlay:e.audio.pending.play,pendingShouldPause:e.audio.pending.pause,pendingPlayNext:e.audio.pending.playNext,pendingPlayPrev:e.audio.pending.playPrev,stockItem:e.audio.meta.stockItem,stockItemArtists:e.audio.meta.stockItemArtists,stockItemFormats:e.audio.meta.stockItemFormats,searchStockItems:(null===(t=e.app.search)||void 0===t?void 0:t.stockItems)||[],collapsedSetStockItems:(null===(i=e.app.search)||void 0===i?void 0:i.collapsedSetStockItems)||[],isLoggedIn:e.auth.isLoggedIn,drawerIsOpen:e.app.search.drawerIsOpen,drawerContentLoaded:e.app.search.drawerContentLoaded,drawerSelectedItemId:e.app.search.drawerSelectedItemId,filtersChanged:e.audio.filtersChanged,context:(null===(s=e.app.search)||void 0===s?void 0:s.context)||"",contentTypeFilter:e.app.search.selectedSearchFilterOptions.contentType}}))(l)}}]);